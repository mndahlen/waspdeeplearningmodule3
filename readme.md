Heavily inspired by

https://github.com/lmnt-com/wavegrad/tree/master